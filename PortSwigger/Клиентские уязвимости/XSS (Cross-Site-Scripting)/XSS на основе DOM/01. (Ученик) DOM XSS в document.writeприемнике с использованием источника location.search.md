Эксплуатация DOM XSS с различными источниками и приемниками
В принципе, веб-сайт уязвим для межсайтового скриптинга на основе DOM, если есть исполняемый путь, по которому данные могут распространяться от источника к приемнику. На практике разные источники и приемники имеют разные свойства и поведение, которые могут влиять на эксплуатируемость и определять, какие методы необходимы. Кроме того, скрипты веб-сайта могут выполнять проверку или другую обработку данных, которые должны быть учтены при попытке эксплуатации уязвимости. Существует множество приемников, которые имеют отношение к уязвимостям на основе DOM. Подробности см. в списке ниже.

Приемник document.writeработает с scriptэлементами, поэтому вы можете использовать простую полезную нагрузку, например, такую, как показано ниже:

document.write('... <script>alert(document.domain)</script> ...');

1. Эта лабораторная работа содержит уязвимость межсайтового скриптинга на основе DOM в функции отслеживания поисковых запросов. Она использует функцию JavaScript document.write, которая записывает данные на страницу. document.writeФункция вызывается с данными из location.search, которые вы можете контролировать с помощью URL-адреса веб-сайта.

Чтобы решить эту лабораторную работу, выполните атаку с использованием межсайтового скриптинга, вызывающего alertфункцию.

1. Вводим случайную буквенно-цифровую строку в поле поиска:

![image](https://github.com/user-attachments/assets/73980a3b-9ba9-47dc-98c0-219d02450d82)

2. Щелкаем правой кнопкой мыши и осматриваем элемент. Обращаем внимание, что наша случайная строка помещена внутрь атрибута img src:

![image](https://github.com/user-attachments/assets/99a4692b-6aea-4763-8cb4-e37b8eebefe7)

3. ВЫходим из img атрибута, выполнив поиск с данной полезной нагрузкой:

"><svg onload=alert(1)>
