Вы можете столкнуться с веб-сайтами, которые кодируют угловые скобки, но все равно позволяют вам внедрять атрибуты. Иногда эти внедрения возможны даже в тегах, которые обычно не запускают события автоматически, таких как канонический тег. Вы можете использовать это поведение, используя клавиши доступа и взаимодействие с пользователем в Chrome. Клавиши доступа позволяют вам предоставлять сочетания клавиш, которые ссылаются на определенный элемент. Атрибут позволяет вам accesskeyопределить букву, которая при нажатии в сочетании с другими клавишами (они различаются на разных платформах) будет вызывать события. В следующей лабораторной работе вы можете поэкспериментировать с клавишами доступа и использовать канонический тег. Вы можете использовать XSS в скрытых полях ввода, используя технику, изобретенную PortSwigger Research .

В этой лабораторной работе пользовательский ввод отражается в каноническом теге ссылки и экранируются угловые скобки.

Для решения лабораторной работы выполните атаку с использованием межсайтового скриптинга на домашнюю страницу, которая внедряет атрибут, вызывающий функцию alert.

Чтобы облегчить вам эксплуатацию, вы можете предположить, что имитируемый пользователь нажмет следующие комбинации клавиш:

ALT+SHIFT+X
CTRL+ALT+X
Alt+X
Обратите внимание, что предполагаемое решение этой лабораторной работы возможно только в Chrome.

1. Перейдите по следующему URL-адресу, заменив его YOUR-LAB-IDидентификатором вашей лаборатории:

https://YOUR-LAB-ID.web-security-academy.net/?%27accesskey=%27x%27onclick=%27alert(1)
Это устанавливает Xклавишу как клавишу доступа для всей страницы. Когда пользователь нажимает клавишу доступа, alertвызывается функция.

2. Чтобы активировать эксплойт на себе, нажмите одну из следующих комбинаций клавиш:
В Windows:ALT+SHIFT+X
На MacOS:CTRL+ALT+X
В Linux:Alt+X

?%27accesskey=%27x%27onclick=%27alert(1):

? — это начало строки запроса (query string) в URL.

%27 — это URL-кодированное значение символа ' (апостроф). Таким образом, %27accesskey=%27x%27 соответствует accesskey='x'.

onclick=%27alert(1) — кодирование onclick='alert(1)', что подразумевает обработчик события onclick, который вызывает функцию alert(1).
Что делает эта инъекция?

Эта строка может быть частью какого-либо параметра в HTML-коде, который обрабатывается сервером.

В данном случае предполагается, что сервер не экранирует входные данные корректно, и код вставляется в HTML-страницу. При этом, когда пользователь взаимодействует с элементом (например, нажимает на кнопку или ссылку), сработает обработчик события onclick, который вызовет функцию alert(1), показывая простой всплывающий алерт с числом 1.
