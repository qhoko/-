Как найти и использовать уязвимости раскрытия информации
В этом разделе мы дадим практические советы по некоторым методам и инструментам, которые вы можете использовать для выявления раскрытия информации в широком диапазоне контекстов. Мы также предоставили несколько лабораторных работ, чтобы вы могли попрактиковаться в извлечении различных видов информации, которые могут быть использованы в рамках дальнейшей атаки.

Тестирование на предмет уязвимостей раскрытия информации
Распространенные источники раскрытия информации LABS
Как проверить уязвимости раскрытия информации
Вообще говоря, важно не развивать «туннельное зрение» во время тестирования. Другими словами, вам следует избегать слишком узкой фокусировки на конкретной уязвимости. Конфиденциальные данные могут утекать в самых разных местах, поэтому важно не упустить ничего, что может оказаться полезным позже. Вы часто будете находить конфиденциальные данные во время тестирования чего-то другого. Ключевой навык — способность распознавать интересную информацию, когда бы и где бы вы с ней ни столкнулись.

Ниже приведены некоторые примеры высокоуровневых методов и инструментов, которые можно использовать для выявления уязвимостей раскрытия информации во время тестирования.

Фаззинг
Использование сканера Burp
Использование инструментов взаимодействия Burp
Разработка информативных ответов
Фаззинг
Если вы определили интересные параметры, вы можете попробовать отправить неожиданные типы данных и специально созданные строки fuzz, чтобы увидеть, какой эффект это даст. Будьте внимательны; хотя ответы иногда явно раскрывают интересную информацию, они также могут намекать на поведение приложения более тонко. Например, это может быть небольшая разница во времени, затраченном на обработку запроса. Даже если содержание сообщения об ошибке ничего не раскрывает, иногда тот факт, что был обнаружен один случай ошибки вместо другого, сам по себе является полезной информацией.

Вы можете автоматизировать большую часть этого процесса с помощью таких инструментов, как Burp Intruder. Это дает несколько преимуществ. В частности, вы можете:

Добавьте позиции полезной нагрузки к параметрам и используйте готовые списки слов нечетких строк для тестирования большого объема различных входных данных в быстрой последовательности.
Легко выявляйте различия в ответах, сравнивая коды статуса HTTP, время ответа, длину и т. д.
Используйте правила сопоставления grep для быстрого определения вхождений ключевых слов, таких как error, invalid, SELECT, SQLи т. д.
Применяйте правила извлечения grep для извлечения и сравнения содержимого интересных элементов в ответах.
Вы также можете использовать расширение Logger++ , доступное в магазине BApp. Помимо регистрации запросов и ответов от всех инструментов Burp, оно позволяет вам определять расширенные фильтры для выделения интересных записей. Это лишь одно из многих расширений Burp, которые могут помочь вам найти любые конфиденциальные данные, которые были украдены веб-сайтом.

Использование сканера Burp
Пользователи Burp Suite Professional получают преимущество от Burp Scanner. Он обеспечивает функции сканирования в реальном времени для аудита элементов во время просмотра, или вы можете запланировать автоматическое сканирование для обхода и аудита целевого сайта от вашего имени. Оба подхода автоматически отметят для вас множество уязвимостей раскрытия информации. Например, Burp Scanner предупредит вас, если найдет в ответе конфиденциальную информацию, такую ​​как закрытые ключи, адреса электронной почты и номера кредитных карт. Он также идентифицирует любые файлы резервных копий, списки каталогов и т. д.

Использование инструментов взаимодействия Burp
Burp предоставляет несколько инструментов взаимодействия, которые вы можете использовать для более легкого поиска интересной информации на целевом веб-сайте. Вы можете получить доступ к инструментам взаимодействия из контекстного меню — просто щелкните правой кнопкой мыши по любому HTTP-сообщению, записи Burp Proxy или элементу на карте сайта и перейдите в «Инструменты взаимодействия».

В этом контексте особенно полезны следующие инструменты.

Поиск
Вы можете использовать этот инструмент для поиска любого выражения в выбранном элементе. Вы можете точно настроить результаты, используя различные расширенные параметры поиска, такие как поиск по регулярным выражениям или отрицательный поиск. Это полезно для быстрого поиска вхождений (или отсутствия) определенных ключевых слов, представляющих интерес.

Найти комментарии
Вы можете использовать этот инструмент для быстрого извлечения любых комментариев разработчиков, найденных в выбранном элементе. Он также предоставляет вкладки для мгновенного доступа к циклу HTTP-запроса/ответа, в котором был найден каждый комментарий.

Откройте для себя контент
Вы можете использовать этот инструмент для определения дополнительного контента и функциональности, которые не связаны с видимым контентом веб-сайта. Это может быть полезно для поиска дополнительных каталогов и файлов, которые не обязательно будут автоматически отображаться на карте сайта.

Разработка информативных ответов
Подробные сообщения об ошибках иногда могут раскрывать интересную информацию, пока вы занимаетесь обычным рабочим процессом тестирования. Однако, изучая, как сообщения об ошибках меняются в зависимости от вашего ввода, вы можете сделать еще один шаг вперед. В некоторых случаях вы сможете манипулировать веб-сайтом, чтобы извлечь произвольные данные с помощью сообщения об ошибке.

Существует множество методов сделать это в зависимости от конкретного сценария, с которым вы сталкиваетесь. Одним из распространенных примеров является попытка логики приложения выполнить недопустимое действие с определенным элементом данных. Например, отправка недопустимого значения параметра может привести к трассировке стека или ответу отладки, содержащему интересные подробности. Иногда вы можете заставить сообщения об ошибках раскрывать значение желаемых вами данных в ответе.

Распространенные источники раскрытия информации
Раскрытие информации может происходить в самых разных контекстах на веб-сайте. Ниже приведены некоторые общие примеры мест, где вы можете проверить, раскрыта ли конфиденциальная информация.

Файлы для веб-сканеров
Списки каталогов
Комментарии разработчиков
Сообщения об ошибках LABS
Отладка данных LABS
Страницы учетной записи пользователя LABS
Резервные файлы LABS
Небезопасная конфигурация LABS
История контроля версий LABS
Файлы для веб-сканеров
Многие веб-сайты предоставляют файлы на /robots.txtи /sitemap.xmlдля того, чтобы помочь сканерам перемещаться по сайту. Помимо прочего, эти файлы часто содержат список определенных каталогов, которые сканеры должны пропускать, например, потому что они могут содержать конфиденциальную информацию.

Поскольку эти файлы обычно не связаны с сайтом, они могут не сразу появиться на карте сайта Burp. Тем не менее, стоит попробовать перейти к /robots.txtили /sitemap.xmlвручную, чтобы посмотреть, найдете ли вы что-нибудь полезное.

Списки каталогов
Веб-серверы можно настроить на автоматическое перечисление содержимого каталогов, в которых отсутствует индексная страница. Это может помочь злоумышленнику, позволяя ему быстро идентифицировать ресурсы по заданному пути и перейти непосредственно к анализу и атаке на эти ресурсы. Это особенно увеличивает уязвимость конфиденциальных файлов в каталоге, которые не предназначены для доступа пользователей, таких как временные файлы и аварийные дампы.

Сами по себе списки каталогов не обязательно являются уязвимостью безопасности. Однако если веб-сайт также не реализует надлежащий контроль доступа, утечка существования и местоположения конфиденциальных ресурсов таким образом, несомненно, является проблемой.

Комментарии разработчиков
В процессе разработки в разметку иногда добавляются встроенные комментарии HTML. Эти комментарии обычно удаляются перед тем, как изменения будут развернуты в рабочей среде. Однако комментарии иногда могут быть забыты, пропущены или даже оставлены намеренно, потому что кто-то не был полностью осведомлен о последствиях для безопасности. Хотя эти комментарии не видны на визуализированной странице, к ним можно легко получить доступ с помощью Burp или даже встроенных в браузер инструментов разработчика.

Иногда эти комментарии содержат информацию, полезную для злоумышленника. Например, они могут намекать на существование скрытых каталогов или давать подсказки о логике приложения.



