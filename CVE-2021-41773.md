CVE-2021-41773
--
### Описание

Возникает в сервере Apache версии 2.4.49 и 2.4.50. Причиной появления уязвимости является в изменении внесенном в нормализацию пути. Уязвимость позволяет прочитать файлы на сервере. В случае неправильной конфигурации уязвимость может позволить выполнять удаленное выполнение кода на сервере. Возникает уязвимость из-за ошибки в обработке URL-запросов с использованием специальной последовательности (../). Ошибка позволяет обойти ограничения, наложенные на доступ к файловой системе. Если сервер настроен для использования файлов .htaccess, то это позволяет получать доступ к файлам за пределами корневогого каталога веб-сервера.

### Патчи

Уязвимость была криво исправлена в обновлении 2.4.50 выпущенном 04/10/2021, из-за чего уязвимость так же попала под версию 2.4.50. Полностью устранена была в версии 2.4.51 выпущенной 07/10/2021.

### Метрики 

Вектор: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
Рейтинг: 7.5 (Высокий)
Уязвимые версии: cpe:2.3:a:apache:http_server:2.4.49 cpe:2.3:a:apache:http_server:2.4.50
Версии до 2.4.49 и после 2.4.50 не затронуты.

### Материалы

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41773
https://nvd.nist.gov/vuln/detail/cve-2021-41773
https://blog.qualys.com/vulnerabilities-threat-research/2021/10/27/apache-http-server-path-traversal-remote-code-execution-cve-2021-41773-cve-2021-42013
https://httpd.apache.org/security/vulnerabilities_24.html

### Эксплуатация

Условия для успешной эксплуатации:

Сервер использует Apache HTTP Server версии 2.4.49 или 2.4.50.
Конфигурация сервера включает директиву: 
<Directory "/path/to/webroot">
    Require all granted
</Directory>
Сервер позволяет доступ к CGI-скриптам (например, /cgi-bin/).

Возможности:

Чтение файлов находящихся на внутреннем сервере: /etc/passwd и др.
Удалённое выполнение кода: в случае возможности загрузки вредоносного файла на сервер, запустить файл можно с помощью обнаруженной уязвимости "Path traversal"

Процесс экплуатации:

Переход на URL с применением кодирования для обхода базовой защиты: http://ip:port/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd
Либо с помощью инструмента "curl" - curl -s --path-as-is "http://iptarget:80/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
В случае уязвимости сервера получаем вывод файла /etc/passwd

### Публичные эксплойты

https://github.com/lorddemon/CVE-2021-41773-PoC/blob/main/CVE-2021-41773.py
https://github.com/walnutsecurity/cve-2021-41773/blob/main/cve-2021-41773.py
https://github.com/iilegacyyii/PoC-CVE-2021-41773/blob/main/CVE-2021-41773.py
