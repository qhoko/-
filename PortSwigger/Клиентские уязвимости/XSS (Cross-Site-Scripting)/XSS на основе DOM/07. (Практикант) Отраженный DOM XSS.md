DOM XSS в сочетании с отраженными и сохраненными данными
Некоторые уязвимости, основанные на чистом DOM, замкнуты в пределах одной страницы. Если скрипт считывает некоторые данные из URL и записывает их в опасный сток, то уязвимость полностью клиентская.

Эта лабораторная работа демонстрирует уязвимость отраженного DOM. Уязвимости отраженного DOM возникают, когда приложение на стороне сервера обрабатывает данные из запроса и выводит их в ответ. Затем скрипт на странице обрабатывает отраженные данные небезопасным способом, в конечном итоге записывая их в опасный приемник.

Чтобы решить эту лабораторную работу, создайте инъекцию, которая вызывает alert()функцию.

1. Подключаем Burp и вводим любое значение в поиск.

2. В Proxy -> HTTP History можем увидеть обращение к файлу /resources/js/searchResults.js и отражение нашей строки в ответе JSON с именем search-results:

![image](https://github.com/user-attachments/assets/4bf94972-1f57-4934-ad7a-e2616ce6ff4c)

3. Открываем файл на карте сайта searchResults.js и обращаем внимание, что ответ JSON используется с eval() вызовом функции:

![image](https://github.com/user-attachments/assets/2b33a19f-82c4-48ce-917f-32be39e5270c)

4. Экспериментируя с различными строками поиска, мы можем определить, что ответ JSON экранирует ковычки, одна обратная косая черта не экранируется.

5. Чтобы решить эту лабораторную работу, введите следующий поисковый запрос: \"-alert(1)}//

Поскольку вы вставили обратную косую черту, а сайт не экранирует их, когда ответ JSON пытается экранировать открывающий символ двойных кавычек, он добавляет вторую обратную косую черту. Результирующая двойная обратная косая черта приводит к тому, что экранирование фактически отменяется. Это означает, что двойные кавычки обрабатываются без экранирования, что закрывает строку, которая должна содержать поисковый запрос.

Затем арифметический оператор (в данном случае оператор вычитания) используется для разделения выражений перед alert()вызовом функции. Наконец, закрывающая фигурная скобка и две косые черты закрывают объект JSON заранее и комментируют то, что было бы остальной частью объекта. В результате ответ генерируется следующим образом:

{"searchTerm":"\\"-alert(1)}//", "results":[]}
