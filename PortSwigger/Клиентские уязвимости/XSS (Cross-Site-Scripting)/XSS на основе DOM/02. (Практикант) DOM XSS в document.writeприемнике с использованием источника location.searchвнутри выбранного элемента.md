Обратите внимание, однако, что в некоторых ситуациях контент, который записывается, document.writeвключает некоторый окружающий контекст, который вам нужно учитывать в вашем эксплойте. Например, вам может потребоваться закрыть некоторые существующие элементы перед использованием вашей полезной нагрузки JavaScript.

Эта лабораторная работа содержит уязвимость межсайтового скриптинга на основе DOM в функциональности проверки акций. Она использует функцию JavaScript document.write, которая записывает данные на страницу. document.writeФункция вызывается с данными, location.searchкоторыми вы можете управлять с помощью URL-адреса веб-сайта. Данные заключены в элемент select.

Чтобы решить эту лабораторную работу, выполните атаку с использованием межсайтового скриптинга, которая выходит за пределы элемента select и вызывает alertфункцию.

1. Переходим на любой продукт, видим возможность проверить наличие на складе, в коде обнаруживаем, что JavaScript извлекает storeIdпараметр из location.searchисточника. Затем он использует его document.writeдля создания новой опции в элементе select для функциональности проверки запасов:

![image](https://github.com/user-attachments/assets/678c0b7f-52a7-451d-94e9-1c91bac53d97)

2. Добавляем storeId параметр запроса к URL и вводим случайную буквенно-цифровую строку в качестве его значения:

![image](https://github.com/user-attachments/assets/e425dd17-87ef-46be-b89b-534869423a7e)

3. Запросите этот измененный URL, после чего можем заметить, что в наша случайная строка отображается как один из параметров:

![image](https://github.com/user-attachments/assets/4b4ed25f-f08a-4d4b-be3f-d078b07e4af2)

4. Вставляем в ссылке в параметр storeId нашу полезную нагрузку вызывающую alert (можно любую другую вызывающую alert): <script>alert('eyes')</script>
