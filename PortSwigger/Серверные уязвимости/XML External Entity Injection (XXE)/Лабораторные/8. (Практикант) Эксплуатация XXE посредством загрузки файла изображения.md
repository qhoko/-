# –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è XXE –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SSRF –∏ —Ä–∞–±–æ—Ç—ã —Å–æ —Å–ª–µ–ø—ã–º XXE üö®

XXE (XML External Entity) ‚Äî —ç—Ç–æ —É—è–∑–≤–∏–º–æ—Å—Ç—å, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ñ–∞–π–ª—ã —Å —Å–µ—Ä–≤–µ—Ä–∞, –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞—Ç–∞–∫–∏ SSRF –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "—Å–ª–µ–ø—ã–µ" —É—è–∑–≤–∏–º–æ—Å—Ç–∏ XXE. –≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —ç—Ç–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏. üí°

---

## –ü–æ–∏—Å–∫ —Å–∫—Ä—ã—Ç–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏ –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è XXE

–ü–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏ –¥–ª—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π XXE –æ—á–µ–≤–∏–¥–Ω–∞ –≤–æ –º–Ω–æ–≥–∏—Ö —Å–ª—É—á–∞—è—Ö, —Ç–∞–∫ –∫–∞–∫ HTTP-—Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–∞—Å—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å XML-–¥–∞–Ω–Ω—ã–º–∏. –û–¥–Ω–∞–∫–æ –∏–Ω–æ–≥–¥–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏ –º–µ–Ω–µ–µ –∑–∞–º–µ—Ç–Ω–∞. –ï—Å–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω—É–∂–Ω—ã–µ –º–µ—Å—Ç–∞, –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ XXE-—É—è–∑–≤–∏–º–æ—Å—Ç–∏ –¥–∞–∂–µ –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç XML.

### –ê—Ç–∞–∫–∏ XInclude

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç –¥–∞–Ω–Ω—ã–µ, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –≤ XML-–¥–æ–∫—É–º–µ–Ω—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∑–∞—Ç–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç –µ–≥–æ. –ü—Ä–∏–º–µ—Ä ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∑–∞–ø—Ä–æ—Å SOAP, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—Ç–µ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Å–ª—É–∂–±–æ–π SOAP.

–í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –∞—Ç–∞–∫—É XXE, —Ç–∞–∫ –∫–∞–∫ —É –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª–Ω–æ–º—É XML-–¥–æ–∫—É–º–µ–Ω—Ç—É, –∏ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç DOCTYPE. –û–¥–Ω–∞–∫–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å XInclude ‚Äî —á–∞—Å—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ XML, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å XML-–¥–æ–∫—É–º–µ–Ω—Ç –∏–∑ –ø–æ–¥–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –í—ã –º–æ–∂–µ—Ç–µ –≤–Ω–µ–¥—Ä–∏—Ç—å XInclude-–∞—Ç–∞–∫—É –≤ –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ XML-–¥–æ–∫—É–º–µ–Ω—Ç–µ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∞—Ç–∞–∫—É –≤–æ–∑–º–æ–∂–Ω–æ–π –¥–∞–∂–µ –ø—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ.

–ü—Ä–∏–º–µ—Ä XInclude –∞—Ç–∞–∫–∏:
```xml
<foo xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include parse="text" href="file:///etc/passwd"/>
</foo>
```

---

## –ü—Ä–∏–º–µ—Ä –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã: XXE —á–µ—Ä–µ–∑ –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞. –ú–Ω–æ–≥–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç XML –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç XML-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã. –ü—Ä–∏–º–µ—Ä—ã ‚Äî –æ—Ñ–∏—Å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (DOCX) –∏ —Ñ–æ—Ä–º–∞—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (SVG).

–ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –î–∞–∂–µ –µ—Å–ª–∏ –æ–∂–∏–¥–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã PNG –∏–ª–∏ JPEG, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å SVG. –ü–æ—Å–∫–æ–ª—å–∫—É SVG –∏—Å–ø–æ–ª—å–∑—É–µ—Ç XML, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ SVG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —Å–∫—Ä—ã—Ç–æ–π –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∞—Ç–∞–∫–∏.

---

### –û–ø–∏—Å–∞–Ω–∏–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏

–≠—Ç–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å –∞–≤–∞—Ç–∞—Ä—ã –∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É Apache Batik –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

–ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é —Ä–∞–±–æ—Ç—É, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–µ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `/etc/hostname` –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É **"–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ"**, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–º—è —Ö–æ—Å—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞.

### –®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 1. –í—ã–±–æ—Ä –ø–æ—Å—Ç–∞
–ù–∞ —Å–∞–π—Ç–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –ø–æ—Å—Ç—ã. –í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π –∏–∑ –Ω–∏—Ö:

![–°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤](https://github.com/user-attachments/assets/b586ef61-9664-4731-9253-e6a1fe924c30)

---

### 2. –ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
–í–Ω–∏–∑—É –ø–æ—Å—Ç–∞ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:

![–†–∞–∑–¥–µ–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤](https://github.com/user-attachments/assets/5052e9f9-f64a-477d-877b-904b37eac029)

---

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ SVG-—Ñ–∞–π–ª–∞
–°–æ–∑–¥–∞–π—Ç–µ SVG-—Ñ–∞–π–ª —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:
```xml
<?xml version="1.0" standalone="yes"?>
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>
<svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
  <text font-size="16" x="0" y="16">&xxe;</text>
</svg>
```

---

### 4. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ª—é–±—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à SVG-—Ñ–∞–π–ª –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:

![–û—Ç–ø—Ä–∞–≤–∫–∞ SVG-—Ñ–∞–π–ª–∞](https://github.com/user-attachments/assets/7767104b-0a0c-4252-bcfa-6a355c903008)

---

### 5. –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
–í–∞—à –∞–≤–∞—Ç–∞—Ä –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `/etc/hostname` –≤ –Ω–µ–±–æ–ª—å—à–æ–º –æ–∫–Ω–µ:

![–†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è hostname](https://github.com/user-attachments/assets/42fb9328-3eca-456f-84fa-bb122028d9a4)
