Инъекция команд ОС
В этом разделе мы объясняем, что такое инъекция команд ОС, и описываем, как уязвимости могут быть обнаружены и использованы. Мы также показываем вам некоторые полезные команды и методы для различных операционных систем и описываем, как предотвратить инъекцию команд ОС.

![image](https://github.com/user-attachments/assets/7bbaad94-aee0-4bf2-ab1e-22fbe67b709a)

Что такое внедрение команд ОС?
Инъекция команд ОС также известна как инъекция оболочки. Она позволяет злоумышленнику выполнять команды операционной системы (ОС) на сервере, на котором запущено приложение, и обычно полностью скомпрометировать приложение и его данные. Часто злоумышленник может использовать уязвимость инъекции команд ОС, чтобы скомпрометировать другие части инфраструктуры хостинга и использовать доверительные отношения, чтобы перенаправить атаку на другие системы в организации.

Внедрение команд ОС
В этом примере приложение для покупок позволяет пользователю просматривать, есть ли товар на складе в определенном магазине. Доступ к этой информации осуществляется через URL:

https://insecure-website.com/stockStatus?productID=381&storeID=29
Чтобы предоставить информацию о запасах, приложение должно запросить различные устаревшие системы. По историческим причинам функциональность реализована путем вызова команды оболочки с идентификаторами продукта и магазина в качестве аргументов:

stockreport.pl 381 29
Эта команда выводит информацию о состоянии запасов указанного товара, которая возвращается пользователю.

Приложение не реализует никакой защиты от внедрения команд ОС, поэтому злоумышленник может отправить следующие входные данные для выполнения произвольной команды:

& echo aiwefwlguh &
Если эти входные данные отправлены в productIDпараметре, команда, выполняемая приложением, будет следующей:

stockreport.pl & echo aiwefwlguh & 29
Команда echoвызывает отображение предоставленной строки в выходных данных. Это полезный способ проверки некоторых типов внедрения команд ОС. Символ &является разделителем команд оболочки. В этом примере он вызывает выполнение трех отдельных команд, одну за другой. Вывод, возвращаемый пользователю, следующий:

Error - productID was not provided
aiwefwlguh
29: command not found
Три строки вывода демонстрируют, что:

Исходная stockreport.plкоманда была выполнена без ожидаемых аргументов, поэтому было возвращено сообщение об ошибке.
Введенная echoкоманда была выполнена, и предоставленная строка была отображена в выходных данных.
Исходный аргумент 29был выполнен как команда, что вызвало ошибку.
Размещение дополнительного разделителя команд &после введенной команды полезно, поскольку он отделяет введенную команду от всего, что следует за точкой введения. Это снижает вероятность того, что то, что следует, помешает выполнению введенной команды.
