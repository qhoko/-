Эта лабораторная работа содержит отраженную уязвимость XSS в функциональности поиска, но использует брандмауэр веб-приложений (WAF) для защиты от распространенных векторов XSS.

Для решения лабораторной работы выполните атаку с использованием межсайтового скриптинга, которая обойдет WAF и вызовет print()функцию.

Примечание
Ваше решение не должно требовать никакого взаимодействия с пользователем. Ручной вызов print()в вашем собственном браузере не решит лабораторную работу.

1. Вводим в строку поиска <> и отправляем, видим, что это блокируется, воспользуемся Burp Intruder, чтобы определить, какие теги и атрибуты блокируются.

2. Включаем Burp, в строку поиска вводим любое значение, в Proxy -> HTTP History отправляем запрос в Intruder, в search?=вставляем <> и между угловыми скобками нажмите добавить §:

![image](https://github.com/user-attachments/assets/747989b7-2e27-47f8-abb9-bb2c877ea05c)

3. Посетите [шпаргалку по XSS](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) и нажмите копировать теги в буфер обмена.

4. Вставье эти теги как полезную нагрузку в разделе Payload configuration нажмите Paste:

![image](https://github.com/user-attachments/assets/fed749a3-a412-4cb5-9f73-266e3a1d554f)

5. Нажмите Start Attack, когда атака будет завершена, посмотрите результаты. Обратите внимание, что большинство полезных нагрузок вызвали 400ответ, но bodyполезная нагрузка вызвала 200ответ.

![image](https://github.com/user-attachments/assets/b7d6b583-f7ac-4750-b780-1ebbf218f23b)

6. Вернитесь в Burp Intruder и замените поисковый запрос на: <body%20=1>, поместите курсор перед = символом и намжите Добавить §, чтобы создать позицию полезной нагрузки. Значение поискового термина теперь должно выглядеть так:<body%20§§=1>

7. Посетите [шпаргалку по XSS](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) и нажмите Копировать события в буфер обмена.

8. Повторите пункт 4. удалив предыдущие значения кнопкой Clear.

9. Когда атака будет завершена, просмотрите результаты. Обратите внимание, что большинство полезных нагрузок вызвали 400ответ, но некоторые полезные нагрузки вызвали 200ответ.

10. Воспользуемся onresize, так как это вызов функции при изменении размера окнаю.

11. Переходим в эксплоит сервер и вставляем в тело (Body) нашу полезную нагрузку: <iframe src="https://your.lab.url.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=alert()%3E" onload=this.style.width='100px'>

12. Нажимаем Посмотреть эксплойт, должен выполниться alert.

13. Возвращаемся на эксплойт сервер, нажимаем Магазин (Store - сохранить) и "Доставить эксплойт жертве".
