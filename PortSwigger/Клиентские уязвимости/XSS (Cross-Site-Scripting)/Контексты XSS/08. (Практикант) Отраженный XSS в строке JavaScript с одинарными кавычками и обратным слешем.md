XSS в JavaScript
Когда контекст XSS представляет собой некоторый существующий JavaScript в ответе, может возникнуть множество ситуаций, для успешного выполнения которых потребуются различные методы.

Завершение существующего скрипта
В простейшем случае можно просто закрыть тег скрипта, который заключает в себе существующий JavaScript, и ввести несколько новых тегов HTML, которые вызовут выполнение JavaScript. Например, если контекст XSS выглядит следующим образом:

<script>
...
var input = 'controllable data here';
...
</script>
то вы можете использовать следующую полезную нагрузку, чтобы выйти за рамки существующего JavaScript и выполнить свой собственный:

</script><img src=1 onerror=alert(document.domain)>
Причина, по которой это работает, заключается в том, что браузер сначала выполняет парсинг HTML для идентификации элементов страницы, включая блоки скрипта, и только потом выполняет парсинг JavaScript для понимания и выполнения встроенных скриптов. Вышеуказанная полезная нагрузка оставляет исходный скрипт сломанным, с незавершенным строковым литералом. Но это не мешает последующему скрипту парситься и выполняться обычным образом.

Эта лаборатория содержит отраженную уязвимость межсайтового скриптинга в функции отслеживания поисковых запросов. Отражение происходит внутри строки JavaScript с экранированными одинарными кавычками и обратными косыми чертами.

Чтобы решить эту лабораторную работу, выполните атаку с использованием межсайтового скриптинга, которая вырывается из строки JavaScript и вызывает alertфункцию.

1. Внедряем в поле поиска скрипт из текста выше: </script><img src=1 onerror=alert(document.domain)>
