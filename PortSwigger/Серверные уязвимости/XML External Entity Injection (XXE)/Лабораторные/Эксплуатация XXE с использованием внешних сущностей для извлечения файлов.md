Использование XXE для извлечения файлов
Чтобы выполнить атаку с использованием XXE-инъекции, которая извлекает произвольный файл из файловой системы сервера, вам необходимо изменить отправленный XML двумя способами:

Введите (или отредактируйте) DOCTYPEэлемент, определяющий внешнюю сущность, содержащую путь к файлу.
Отредактируйте значение данных в XML, возвращаемом в ответе приложения, чтобы использовать определенную внешнюю сущность.
Например, предположим, что приложение для совершения покупок проверяет уровень запасов товара, отправляя на сервер следующий XML-код:

<?xml version="1.0" encoding="UTF-8"?>
<stockCheck><productId>381</productId></stockCheck>
Приложение не обеспечивает особой защиты от атак XXE, поэтому вы можете воспользоваться уязвимостью XXE для извлечения /etc/passwdфайла, отправив следующую полезную нагрузку XXE:

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck><productId>&xxe;</productId></stockCheck>
Эта полезная нагрузка XXE определяет внешнюю сущность &xxe;, значением которой является содержимое файла /etc/passwd, и использует сущность внутри productIdзначения. Это приводит к тому, что ответ приложения включает содержимое файла:

Invalid product ID: root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
...
Примечание
При реальных уязвимостях XXE в отправленном XML часто будет большое количество значений данных, любое из которых может быть использовано в ответе приложения. Для систематического тестирования на уязвимости XXE вам, как правило, нужно будет протестировать каждый узел данных в XML по отдельности, используя определенную вами сущность и проверяя, появляется ли она в ответе.

1. Нас встречает список товаров:

![image](https://github.com/user-attachments/assets/7732ce0b-262f-4416-aebe-a7af11b5d714)

---

2. Переходим на любой из них, включив прокси бурпа, нажимаем на кнопку "Проверить наличие на складе":

![image](https://github.com/user-attachments/assets/be6726cc-64f5-4093-b301-7923e3d88d9c)

---

3. В HTTP History полученный POST запрос перекидываем в Repeater, видим, что проверка наличия производится с помощью XML, это и будет нашим вектором атаки:

![image](https://github.com/user-attachments/assets/028c10b5-e477-45f5-8101-8a056ed72651)

---

4. Вставляем следующее определение внешней сущности между декларацией XML и stockCheck элементом: <!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>, и в productId значение меняем на &xxe;, должно получиться вот так: 

![image](https://github.com/user-attachments/assets/22cbd669-befa-4e8b-9250-da047534f851)

---

5. Получаем вывод /etc/passwd: 

![image](https://github.com/user-attachments/assets/7c506f3a-d652-4bad-820c-2b61fa561bf5)
---
